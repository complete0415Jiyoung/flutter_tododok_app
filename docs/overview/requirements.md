# ✅ **토도독(Tododok) 기능 요구사항 정의서**

---

## 📌 1. 프로젝트 개요

> 토도독은 모바일 환경에서 한글과 영문 타자 실력을 재미있게 기를 수 있는 타자 연습 어플입니다.
> 
> 연습뿐만 아니라 친구에게 도전장을 보내 **비동기 대결**을 펼치는 기능을 통해
> 
> 재미 요소와 반복 학습을 결합합니다.

---

## 🛠 2. 필요한 기술 스택

### 🖥 Frontend

| 영역 | 기술 |
| --- | --- |
| UI 프레임워크 | Flutter |
| 상태 관리 | Riverpod 2.x – 타입 안전한 상태 관리 |
| 데이터 클래스 | Freezed – 불변 데이터 클래스 생성 |
| 라우팅 | Go Router – 선언적 라우팅 |
| 디자인 협업 | Figma |

### 🔧 Backend (예정)

| 영역 | 기술 |
| --- | --- |
| 인증 / 실시간 통신 | Firebase Authentication, Firestore |
| 함수형 처리 | Firebase Cloud Functions |
| URL 공유 | Firebase Dynamic Links |
| 알림 | Firebase Cloud Messaging (FCM) |

---

## 🏗 3. 아키텍처 설계

### 전체 구조

- **패턴**: MVVM + MVI + Root 패턴
- **디렉토리 구조**: 기능 기반 Feature-first 구조
- **레이어 분리**:
    - `Presentation`: UI 및 ViewModel
    - `Domain`: UseCase, Entity
    - `Data`: Repository, DTO, Remote API

### 주요 설계 원칙

- 🔁 **단방향 데이터 흐름**
- 🔌 **의존성 역전 (DIP)** – 인터페이스 기반 주입
- 🧩 **관심사 분리** – UI / 도메인 / 데이터 계층 구분
- ✅ **테스트 가능 구조** – 단위 테스트 및 뷰모델 테스트 용이

---

## 📋 4. 기능 요구사항

### 1. 📱 타자 연습

- [ ]  한글 / 영어 자판 선택 (시스템 기본 키보드 사용)
- [ ]  단어 대결 모드 (떨어지는 단어들을 제한 시간 내 입력하는 게임형 대결)
- [ ]  장문 연습 모드 제공
- [ ]  실시간 타자 속도(WPM) 계산
- [ ]  오타 및 정확도 분석
- [ ]  연습 결과 시각화 및 저장
- [ ]  단어 대결 모드 (단어가 위에서 떨어지고, 시간 내 입력해야 하는 게임형)
- [ ]  자판 커스터마이징 ❌ (MVP 제외)

---

### 2. 🧾 연습 결과 기록

- [ ]  Firebase 익명 로그인
- [ ]  연습 결과 Firestore에 저장
- [ ]  최근 연습 결과 리스트 조회
- [ ]  간단한 타자 통계 제공 (정확도/속도 평균)
- [ ]  월간 통계 / 랭킹 기능 ❌ (후속 버전)

---

### 3. 👯 친구 대결 (비동기 방식)

- [ ]  연습 후 "도전장" 생성
- [ ]  Firebase Dynamic Link로 도전장 공유
- [ ]  상대는 같은 문장으로 타자 후 결과 제출
- [ ]  Firestore에 결과 저장 및 비교
- [ ]  승/패 결과 시각화 및 표시
- [ ]  재대결 요청 ❌ (후속 버전)

---

### 4. 🔔 푸시 알림 (FCM)

- [ ]  친구가 도전장을 수락했을 때 알림 발송
- [ ]  친구가 결과를 제출했을 때 알림 발송
- [ ]  앱 실행 시 FCM 토큰 Firestore에 저장
- [ ]  Cloud Function을 통해 Firestore 변경 감지 → 알림 전송

---

### 5. 🧭 앱 구조 및 네비게이션

- [ ]  홈 화면: 연습 / 대결 / 기록 탭 구성
- [ ]  Go Router를 통한 화면 전환
- [ ]  도전장 접속 시 자동 라우팅 처리
- [ ]  예외 처리: 잘못된 링크, 결과 없음 등

---

### 6. 🎨 UI/UX

- [ ]  세련되고 깔끔한 디자인 (Figma 기반)
- [ ]  실시간 입력 피드백 (입력 색상 / 오타 표시)
- [ ]  결과 화면: 카드 형식, WPM 및 정확도 강조
- [ ]  다크모드 / 라이트모드 지원 예정
- [ ]  모바일 최적화 (반응형 폰트, 간결한 화면 흐름)

---

## 📌 비기능 요구사항

| 항목 | 내용 |
| --- | --- |
| 플랫폼 | Flutter 기반 iOS / Android 동시 지원 |
| 인증 방식 | Firebase 익명 로그인 |
| 데이터 저장 | Firestore (NoSQL 실시간 DB) |
| 푸시 | FCM + Firebase Cloud Functions |
| 배포 | Google Play Store, App Store 예정 |
| 협업 툴 | Figma, Notion, GitHub, Discord |

---

## 🚫 제외 항목 (MVP 이후 고려)

- 실시간 대결 (동기식)
- 정식 회원가입 / 프로필 기능
- 친구 목록 및 리매치
- 대결 랭킹 / 글로벌 통계
- 광고 / 결제 시스템

## 🔤 자판 설정 관련 요구사항

- 앱 최초 실행 시 `keyboardPreference`는 `"ko"`(한글)로 자동 설정된다.
- 사용자는 설정 페이지에서 한글 / 영문 중 기본 자판을 변경할 수 있다.
- 모든 연습/대결 시 자판은 해당 설정을 기반으로 자동 적용된다.

---

## 🔔 도전장 알림 설정 관련 요구사항

- 도전장 알림은 수락 및 결과 제출 알림을 포함한 **단일 알림**으로 구성된다.
- 사용자는 설정 페이지에서 **토글 하나로 전체 도전장 알림 수신 여부**를 관리한다.
- 기본값은 `true`이며 Firestore `users.allowChallengeNotification` 필드에 저장된다.

---

## 📬 알림함 기능

- 사용자는 알림함에서 수신한 도전장 알림을 목록 형태로 확인할 수 있다.
- 알림을 클릭하면 해당 도전장 수락 화면으로 이동한다.
- 알림 클릭 시 내부적으로 `challengeId` 파라미터를 전달받아 라우팅 처리된다.

---

## 🧭 도전장 수락 경로 다양화

- 도전장은 아래 3가지 경로로 수락 가능하다:
  1. 홈 메뉴 → 친구 대결 → 도전장 수락
  2. 알림함에서 클릭
  3. 친구가 공유한 Firebase Dynamic Link 클릭
- 어떤 경로든 동일한 문장 연습 화면으로 이동하며 결과 비교 흐름은 동일하다.
